<div class="container">
    <h1>Missions</h1>

    <div class="row mb-3">
        <div class="col-md-12">
            <button class="btn btn-primary" (click)="toggleAdd()">Ajouter une mission</button>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Titre</th>
                        <th>Description</th>
                        <th>Catégorie</th>
                        <th>Horaire</th>
                        <th>Priorité</th>
                        <th>Contact</th>
                        <th>Visible</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let mission of missions">
                        <td>{{ mission.title }}</td>
                        <td>{{ mission.description }}</td>
                        <td>{{ mission.category }}</td>
                        <td>{{ mission.horaire }}</td>
                        <td>{{ mission.priority }}</td>
                        <td>{{ mission.contact }}</td>
                        <td>{{ mission.visibility ? 'Oui' : 'Non' }}</td>
                        <td>
                            <button class="btn btn-sm btn-primary"
                                (click)="selectMission(mission); toggleEdit()">Modifier</button>
                            <button class="btn btn-sm btn-danger" (click)="deleteMission(mission.id)">Supprimer</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div *ngIf="isAdding || isEditing" class="modal fade show" tabindex="-1" role="dialog"
        style="display: block; background-color: rgba(0, 0, 0, 0.5);">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{ isAdding ? 'Ajouter une mission' : 'Modifier une mission' }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="cancel()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="title">Titre</label>
                            <input type="text" class="form-control" id="title" [(ngModel)]="selectedMission.title"
                                name="title" required>
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea class="form-control" id="description" [(ngModel)]="selectedMission.description"
                                name="description" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="category">Catégorie</label>
                            <input type="text" class="form-control" id="category" [(ngModel)]="selectedMission.category"
                                name="category" required>
                        </div>
                        <div class="form-group">
                            <label for="horaire">Horaire</label>
                            <input type="text" class="form-control" id="horaire" [(ngModel)]="selectedMission.horaire"
                                name="horaire" required>
                        </div>
                        <div class="form-group">
                            <label for="priority">Priorité</label>
                            <input type="number" class="form-control" id="priority"
                                [(ngModel)]="selectedMission.priority" name="priority" required>
                        </div>
                        <div class="form-group">
                            <label for="contact">Contact</label>
                            <input type="text" class="form-control" id="contact" [(ngModel)]="selectedMission.contact"
                                name="contact">
                        </div>
                        <div class="form-group">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="visibility"
                                    [(ngModel)]="selectedMission.visibility" name="visibility">
                                <label class="form-check-label" for="visibility">
                                    Visible
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                        (click)="cancel()">Annuler</button>
                    <button type="button" class="btn btn-primary"
                        (click)="isAdding ? addMission(selectedMission) : editMission(selectedMission)">Enregistrer</button>
                </div>
            </div>
        </div>
    </div>